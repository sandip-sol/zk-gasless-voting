(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26198,16272,e=>{"use strict";e.s(["CONFIG",0,{chainId:31337,rpcUrl:"http://127.0.0.1:8545",relayerUrl:"http://localhost:4000",contracts:{PollFactory:"0xCf7Ed3AccA5a467e9e704C703E8D87F634fB0Fc9",EligibilityAggregator:"0x5FbDB2315678afecb367f032d93F642f64180aa3",MockSemaphoreVerifier:"0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512",Forwarder:"0x5FC8d32690cc91D4c39d9d3abcBD16989F875707"}}],26198),e.s(["AnonPollABI",0,[{inputs:[{internalType:"uint256",name:"_pollId",type:"uint256"},{internalType:"string",name:"_questionCID",type:"string"},{internalType:"uint64",name:"_start",type:"uint64"},{internalType:"uint64",name:"_end",type:"uint64"},{internalType:"uint256",name:"optionsCount",type:"uint256"},{internalType:"address",name:"_aggregator",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"nullifier",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"option",type:"uint256"}],name:"Voted",type:"event"},{inputs:[],name:"aggregator",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"end",outputs:[{internalType:"uint64",name:"",type:"uint64"}],stateMutability:"view",type:"function"},{inputs:[],name:"pollId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"questionCID",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"results",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"start",outputs:[{internalType:"uint64",name:"",type:"uint64"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"tallies",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"usedNullifier",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"option",type:"uint256"},{internalType:"address",name:"verifier",type:"address"},{internalType:"bytes",name:"proofData",type:"bytes"}],name:"vote",outputs:[],stateMutability:"nonpayable",type:"function"}],"PollFactoryABI",0,[{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"pollId",type:"uint256"},{indexed:!1,internalType:"address",name:"poll",type:"address"},{indexed:!1,internalType:"string",name:"questionCID",type:"string"}],name:"PollCreated",type:"event"},{inputs:[{internalType:"string",name:"questionCID",type:"string"},{internalType:"uint64",name:"start",type:"uint64"},{internalType:"uint64",name:"end",type:"uint64"},{internalType:"uint256",name:"optionsCount",type:"uint256"},{internalType:"address",name:"aggregator",type:"address"}],name:"createAnonPoll",outputs:[{internalType:"address",name:"poll",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"nextId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}]],16272)},82866,e=>{"use strict";var t=e.i(8049),n=e.i(80661),i=e.i(79884),a=e.i(71793),r=e.i(27060),s=e.i(26198),l=e.i(16272),o=e.i(85968);function u(){let{provider:e}=(0,o.useWallet)(),[n,u]=(0,i.useState)([]),[d,p]=(0,i.useState)(!0);return((0,i.useEffect)(()=>{(async()=>{try{let t=e||new a.ethers.JsonRpcProvider(s.CONFIG.rpcUrl),n=new a.ethers.Contract(s.CONFIG.contracts.PollFactory,l.PollFactoryABI,t),i=n.filters.PollCreated(),r=await n.queryFilter(i),o=await Promise.all(r.map(async e=>{let{pollId:n,poll:i,questionCID:r}=e.args,s=new a.ethers.Contract(i,l.AnonPollABI,t),o=await s.start(),u=await s.end();return{id:Number(n),address:i,question:r,start:Number(o),end:Number(u)}}));u(o.reverse())}catch(e){console.error("Error fetching polls:",e)}finally{p(!1)}})()},[e]),d)?(0,t.jsx)("div",{children:"Loading polls..."}):(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[n.map(e=>(0,t.jsx)(r.default,{href:`/polls/${e.id}`,className:"block group",children:(0,t.jsxs)("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm hover:shadow-md transition-shadow p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2 group-hover:text-primary transition-colors",children:e.question}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,t.jsxs)("p",{children:["Poll ID: ",e.id]}),(0,t.jsxs)("p",{children:["Ends: ",new Date(1e3*e.end).toLocaleDateString()]})]})]})},e.id)),0===n.length&&(0,t.jsx)("div",{className:"col-span-full text-center text-muted-foreground",children:"No polls found. Create one!"})]})}function d(){let{provider:e,account:n,connect:r}=(0,o.useWallet)(),[u,d]=(0,i.useState)(""),[p,c]=(0,i.useState)(2),[m,y]=(0,i.useState)(3600),[b,f]=(0,i.useState)(!1),g=async t=>{if(t.preventDefault(),!e||!n)return void r();f(!0);try{let t=await e.getSigner(),n=new a.ethers.Contract(s.CONFIG.contracts.PollFactory,l.PollFactoryABI,t),i=Math.floor(Date.now()/1e3),r=await n.createAnonPoll(u,i,i+m,p,s.CONFIG.contracts.EligibilityAggregator);await r.wait(),alert("Poll created successfully!"),d(""),window.location.reload()}catch(e){console.error("Failed to create poll:",e),alert("Failed to create poll")}finally{f(!1)}};return(0,t.jsxs)("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Create Poll"}),(0,t.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Question"}),(0,t.jsx)("input",{type:"text",value:u,onChange:e=>d(e.target.value),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Options Count"}),(0,t.jsx)("input",{type:"number",min:"2",value:p,onChange:e=>c(parseInt(e.target.value)),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Duration (seconds)"}),(0,t.jsx)("input",{type:"number",min:"60",value:m,onChange:e=>y(parseInt(e.target.value)),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",required:!0})]}),(0,t.jsx)("button",{type:"submit",disabled:b,className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 px-4 py-2 w-full",children:b?"Creating...":"Create Poll"})]})]})}function p(){let e,i,a=(0,n.c)(2);return a[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsxs)("section",{children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Active Polls"})}),(0,t.jsx)(u,{})]}),a[0]=e):e=a[0],a[1]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsxs)("div",{className:"space-y-8",children:[e,(0,t.jsx)("section",{className:"border-t pt-8",children:(0,t.jsx)(d,{})})]}),a[1]=i):i=a[1],i}e.s(["default",()=>p],82866)}]);